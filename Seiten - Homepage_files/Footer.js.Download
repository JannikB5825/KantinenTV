window.BenderFooterNavigation = window.BenderFooterNavigation || {};

window.BenderFooterNavigation.FooterArea = function (footerDiv) {
    var container = footerDiv;

    this.getAddressData = function () {
/*
        $.ajax(
        {
            url: BenderFooterNavigation.RestAPI.AddressData,
            headers: {
                accept: 'application/json; odata=verbose'
            },
            method: 'get',
            success: function (data, status, result) {
                if (result.responseJSON.d.results.length < 1) {
                    return;
                }
                var item = result.responseJSON.d.results[0];

                $("#addressRow1", container).html(item.FooterAddress1);
                $("#addressRow2", container).html(item.FooterAddress2);
                $("#tel", container).html(item.WorkPhone);
                $("#fax", container).html(item.WorkFax);
                $("#email", container).html(item.EMail);
            }
        });
*/
    }

    this.getLinks = function () {
/*
        $.ajax({
            url: BenderFooterNavigation.RestAPI.Urls,
            headers: {
                accept: 'application/json; odata=verbose'
            },
            method: 'get',
            success: function (data, status, result) {
                if (result.responseJSON.d.results.length < 1) {
                    return;
                }

                populateLinks(result.responseJSON.d.results);
            }
        });
*/
    }

    this.getContactDetails = function () {
/*
        $.ajax({
            url: BenderFooterNavigation.RestAPI.ContactPerson,
            method: 'get',
            headers: {
                accept: 'application/json; odata=verbose'
            },
            success: function (data, status, result) {
                if (result.responseJSON.d.results.length < 1) {
                    return;
                }

                var item = result.responseJSON.d.results[0];
                populateContact(item);
            }
        });
*/
    }

    function populateContact(item) {
        $.ajax({
            url: BenderFooterNavigation.RestAPI.UserEmail(item.ContactPerson.ID),
            method: 'get',
            headers: {
                accept: 'application/json; odata=verbose'
            },
            success: function (data, status, result) {
                var user = result.responseJSON.d;
                $("#contact").append("<a href='mailto:" + user.Email + "'>" + user.Title + "</a>");
                $(".contact").attr('title', user.Email);
            }
        });
    }

    function populateLinks(links) {
        var headers = {};
        for (var i = 0; i < links.length; i++) {
            var link = links[i];
            if (headers[link.LinkCategory])
                headers[link.LinkCategory].push(link.URL);
            else
                headers[link.LinkCategory] = [link.URL];
        }

        $(".links").append($('<table id="links-table">'));
        $("#links-table").append("<tr>");
        for (var header in headers) {
            $("#links-table tr:first").append("<td>");
            $("#links-table td:last").append("<ul>");

            var list = $("#links-table td:last ul");

            list.append("<li class='header'>" + header.substr(4) + "</li>");
            var headerLinks = headers[header];
            for (i = 0; i < headerLinks.length; i++) {
                list.append("<li><a href='" + headerLinks[i].Url + "'>" + headerLinks[i].Description + "</a></li>");
            }
        }
    }
}

$( document ).ready(function() {
	// Bender-Footer [F.Schiffke, 28.08.2015]
	$("#footerArea").html(" \
		<span class='footerslogan' style='font-size:14px;'> \
			<b>Bender.</b> The Power in Electrical Safety.<sup>©</sup> \
		</span> \
		<br/><br/> \
		<span class='copyright'>© Bender GmbH &amp; Co. KG</span> \
		<span class='tel'> \
			<img src='/de/PublishingImages/Telefon_Icon_invertiert_50px.png' style='padding-left:30px;' height='30' /> \
			Tel. +49 6401 807-0 \
		</span> \
		<span class='email'> \
			<img src='/de/PublishingImages/Mail2_Icon_invertiert_50px.png' style='padding-left:30px;' height='30'> \
			E-Mail: <a style='color:#e6e6e6;' href='mailto:info@bender.de'>info@bender.de</a> \
		</span> \
		<div id='footerContact' style='float:right;'> <span style='display:inline-block;padding:18px 5px 0 0;vertical-align:top;'>Feedback: </span>\
			<a href='mailto:feedback@mybender.com' style='color:#e6e6e6;'> \
				<img src='/de/scripts/feedback-icon.jpg' style='height:40px;'/> \
			</a> \
		</div> \
		<div><img src='/de/PublishingImages/icons/Quicklinks_Icon.png' height='50' id='quicklinks-button' onclick='toggleQuicklinks();'/></div><div id='quicklinks'></div> \
	");
	$("#footerArea").prepend(" \
		<script type='text/javascript' src='/de/scripts/quicklinks.js'></script> \
		<link rel='stylesheet' type='text/css' href='/de/scripts/quicklinks.css'/> \
	");

	//PDFs in neuem Tab öffnen
	$("a[href*='.pdf']").attr('target', '_blank').prop("onclick", null).attr("onmousedown", null);
	//RTFs in neuem Tab öffnen
	$("a[href*='.rtf']").attr('target', '_blank').prop("onclick", null).attr("onmousedown", null);
	//DOCs in neuem Tab öffnen
	$("a[href*='.doc']").attr('target', '_blank').prop("onclick", null).attr("onmousedown", null);
	$("a[href*='.docx']").attr('target', '_blank').prop("onclick", null).attr("onmousedown", null);
	//Portal-Links in neuem Tab öffnen
	$("a[href*='portal.intra.bender']").attr('target', '_blank').prop("onclick", null).attr("onmousedown", null);
	// Quicklinks anzeigen
	$('#quicklinks').load('/de/scripts/quicklinks.html');

	//Links zum Portal kennzeichnen
	$('a[href*="portal.intra.bender"]').append("<img src='/de/scripts/ecke.png' style='padding-left:5px; height:10px;' class='pfeil-zum-alten-sp'/>");
	$('img[src*="ecke"]').siblings('.pfeil-zum-alten-sp').css("display","none");


});